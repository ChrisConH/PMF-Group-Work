---
title: "Homework assignment 1. Programación y modelación financiera (PMF)"
author: "XXXX XXXX, Lara Weitgasser A01759114"
date: "8/29/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyquant)
library(ggplot2)
library(quantmod)
library(finreportr)
library(tibble)
library(tbl2xts)
library(dplyr)
library(lazyeval)
```

## From prices to returns
At first we loaded and plotted the data for the four companies Amazon, Facebook, Google and Netflix for the timeframe 2016-12-30 to 2021-07-31 in order to compare them to the FANG dataset that ends in 2016.

```{r cars}
#Plot: Amazon, Facebook, Google and Netflix 2016-12-30 to 2021-07-31
Stock_AFGN <- tq_get(c("AMZN","FB","GOOG","NFLX"))%>%
     group_by(symbol) %>%
     ggplot(aes(x = date, y = adjusted, color = symbol)) +
     geom_line(size = 1) +
     coord_x_date(xlim = c("2016-12-30","2021-07-31"))+
     labs(title = "Daily stock prices - 2016-12-30 to 2021-07-31",
          x = "", y = "Adjusted prices", color = "") +
     scale_y_continuous(labels = scales::dollar) +
     theme_tq() + scale_color_tq()
Stock_AFGN
```
As this plot distorts the perspective on the stock market of the four companies, the next plot shows the four companies separated in order to make comparisons easier and valuable.

```{r}
#Amazon, Facebook, Google and Netflix 2016-12-30 to 2021-07-31
Stock_AFGN <- tq_get(c("AMZN","FB","GOOG","NFLX"))%>%
     group_by(symbol) %>%
     ggplot(aes(x = date, y = adjusted, color = symbol)) +
     geom_line(size = 1) +
     coord_x_date(xlim = c("2016-12-30","2021-07-31"))+
     labs(title = "Daily stock prices - 2016-12-30 to 2021-07-31",
          x = "", y = "Adjusted prices", color = "") +
        facet_wrap(~ symbol, ncol = 2, scales = "free_y") +
     scale_y_continuous(labels = scales::dollar) +
     theme_tq() + scale_color_tq()
Stock_AFGN
```
The above plot has the strength of showing the companies separated, however, to make a good comparison, it is important to look at annual returns which is shown below.

```{r}
#Annual returns of Amazon, Facebook, Google and Netflix from 2017 to 2021
Stock_AFGN_annual_returns <- tq_get(c("AMZN","FB","GOOG","NFLX"))%>%
     group_by(symbol) %>%
        filter(date>"2016-12-30")%>%
        tq_transmute(select = adjusted,
        mutate_fun = periodReturn,
        period = "yearly",
        type = "arithmetic")

Stock_AFGN_annual_returns
```


```{r}
Stock_AFGN_annual_returns %>%
ggplot(aes(x = date-365, y = yearly.returns, fill = symbol)) +
geom_col() +
geom_hline(yintercept = 0, color = palette_light()[[1]]) +
scale_y_continuous(labels = scales::percent) +
labs(title = "FANG: Annual Returns",
y = "Annual Returns", x = "") +
facet_wrap(~ symbol, ncol = 2, scales = "free_y") +
theme_tq() + scale_fill_tq()
```


